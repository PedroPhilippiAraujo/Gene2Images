---
title: Gene2Images
format: html
---

## Introduction

This code will be use to acquire data and visualize it.

## Data Acquisition and Extraction

```{python}

import os
import urllib.request
import tarfile

url = "https://cbioportal-datahub.s3.amazonaws.com/brca_metabric.tar.gz"
archive_path = "../data/brca_metabric.tar.gz"

if not (os.path.exists("../data")):
    os.mkdir("../data")

if not (os.path.exists("../artifacts")):
    os.mkdir("../artifacts")

if (os.path.exists(archive_path)):
    print("Data already downloaded")
else:
    print("Downloading Data")
    urllib.request.urlretrieve(url, archive_path)
    print("Download Complete")


with tarfile.open(archive_path, "r") as tar:
    print("Extracting archive")
    tar.extractall(path="../data/")
    print("Extraction complete")


```


## Data Framing

```{python}
import pandas as pd

metabric_dir = "../data/brca_metabric"
data_path = f"{metabric_dir}/data_mrna_illumina_microarray_zscores_ref_diploid_samples.txt"
metadata_path = f"{metabric_dir}/data_clinical_patient.txt"

#Read gene expression data
expr_df = pd.read_csv(data_path, sep="\t")
expr_df = expr_df.set_index("Entrez_Gene_Id")

expr_df = expr_df.drop(columns=["Hugo_Symbol"])

X = expr_df.T

meta_df = pd.read_csv(metadata_path, sep="\t", comment="#")
meta_df = meta_df.set_index("PATIENT_ID")




#print(f"data shape: {X.shape}")
#print(f"metadata shape: {meta_df.shape}")

```

## Data Plotting

```{python}
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

#print(X.describe())
#print(X.head())
#print(meta_df.describe())

X_long = X.melt(var_name="Feature", value_name="Value")

#Gene Plot
plt.figure()
sns.histplot(X_long["Value"], bins=50)
plt.title("Histogram")
plt.xlabel("Value")
plt.ylabel("Count")
plt.tight_layout()
plt.show()
plt.savefig("../artifacts/images/GenePlot.png")
plt.close()

#Claudin Subtype Plot
plt.figure()
sns.histplot(meta_df["CLAUDIN_SUBTYPE"], bins=7)    
plt.title("Claudin Subtype Count")
plt.xlabel("Subtype")
plt.ylabel("Count")
plt.tight_layout()
plt.show()
plt.savefig("../artifacts/images/Claudin.png")
plt.close()

```


## Drop bad values

```{python}

```
